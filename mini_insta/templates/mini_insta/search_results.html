<!-- # File: search_results.html
# Author: Leigh Brown (ljbrown@bu.edu), 2/26/2026
# Description: scriptlet code to display results from searcg -->

{% extends 'mini_insta/base.html' %}
 
{% block content %}
<main class="container">

    <h3 style="text-align: center;">Search Results</h3>
    <br>
    <h3>profiles</h3>
    <hr>
    <br>
    {% if profiles %}
        {% for p in profiles%}
            <div class="double">
                <div class="imgside2">
                    {% if p.profile_image_url%}
                    <a href="{% url 'profile' p.pk %}"><img id="personalprofile" src="{{p.profile_image_url}}"></a>
                    {% endif %}
                    <br>
                </div>
                <div class="post-info">
                    <a href="{% url 'profile' p.pk %}"><h5><i>{{p.display_name}}</i></h5></a>
                    <p> {{p.username}}</p>
                    <br>
                    <p> {{p.bio_text}}</p>
                </div>
            </div>
        {% endfor %}
    {% else %}
        <h4 style="text-align: center;">No matching profiles.</h4>
    {% endif %}
    
    <br>
    <h3> posts</h3>
    <hr>
    <br>
    {% if posts %}
        {% for post in posts%}
            <div class="double2">
                <div class="imgside2">
                    {% if post.get_all_photos %}
                        {% with a=post.get_first_photo %}
                            <a href="{% url 'post' post.pk %}"> 
                            <img class="post-image" src="{{a.get_image_url}}">
                        </a>
                        {% endwith %}
                    {% endif%}
                </div>
                    <div class="post-info">
                        <div style="display: flex; gap: 30px; align-items: center;">
                            <h4> {{post.profile.display_name}}</h4> 
                            <p> @{{post.profile.username}} </p>
                        </div>
                        <hr>
                        <br>
                        {% if post.caption %}
                            <p> <b>@{{post.profile.username}}: </b>{{post.caption}}</p>
                        {% endif %}

                        <p style="color:rgb(167, 167, 167)"> timestamp: {{post.timestamp}}</p>

                        {%if post.get_likes %}
                            <div style="display: flex; gap: 5px; align-items: center;">
                                {% with a=post.get_first_like %}
                                    <p> Liked by <b>{{a.profile.username}}</b></p>
                                {% endwith %}

                                {%if post.get_num_likes >= 1 %}
                                    <p> <b> and {{post.get_num_likes}} others</b></p>
                                {% endif %}
                            </div>
                        {% endif %}

                        <br>
                        {% for c in post.get_all_comments%}
                            <div style="display: flex; gap: 30px; align-items: center;">
                                <h5><b>@{{c.profile.username}}</b></h5>
                                <p>{{c.text}}</p>
                            </div>
                        {% endfor %}
                </div>
                <br>
            </div>
        {% endfor %}
    {% else %}
        <h4 style="text-align: center;">No matching posts.</h4>
    {% endif %}
</main>
{% endblock %}